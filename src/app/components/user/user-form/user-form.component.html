<h2>{{ userId ? 'Edit User' : 'Create New User' }}</h2>
<form [formGroup]="userForm" (ngSubmit)="onSubmit()">
  <mat-form-field appearance="fill">
    <mat-label>Name</mat-label>
    <input matInput formControlName="name">
    <mat-error *ngIf="userForm.get('name')?.hasError('required')">Name is required</mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Email</mat-label>
    <input matInput formControlName="email">
    <mat-error *ngIf="userForm.get('email')?.hasError('required')">Email is required</mat-error>
    <mat-error *ngIf="userForm.get('email')?.hasError('email')">Invalid email format</mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Password</mat-label>
    <input matInput type="password" formControlName="password">
    <mat-error *ngIf="userForm.get('password')?.hasError('required')">Password is required</mat-error>
  </mat-form-field>

  <div formArrayName="telephones">
    <h3>Telephones</h3>
    <div *ngFor="let telephone of telephones.controls; let i = index" [formGroupName]="i">
      <mat-form-field appearance="fill">
        <mat-label>Country Code</mat-label>
        <input matInput formControlName="codeCountry">
        <mat-error *ngIf="telephone.get('codeCountry')?.hasError('required')">Country Code is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>State Code</mat-label>
        <input matInput formControlName="codeState">
        <mat-error *ngIf="telephone.get('codeState')?.hasError('required')">State Code is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Number</mat-label>
        <input matInput formControlName="number">
        <mat-error *ngIf="telephone.get('number')?.hasError('required')">Number is required</mat-error>
      </mat-form-field>

      <button mat-icon-button color="warn" (click)="removeTelephone(i)">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
    <button mat-raised-button color="primary" (click)="addTelephone()">Add Telephone</button>
  </div>

  <div formArrayName="addresses">
    <h3>Addresses</h3>
    <div *ngFor="let address of addresses.controls; let i = index" [formGroupName]="i">
      <mat-form-field appearance="fill">
        <mat-label>Street</mat-label>
        <input matInput formControlName="street">
        <mat-error *ngIf="address.get('street')?.hasError('required')">Street is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>City</mat-label>
        <input matInput formControlName="city">
        <mat-error *ngIf="address.get('city')?.hasError('required')">City is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>State</mat-label>
        <input matInput formControlName="state">
        <mat-error *ngIf="address.get('state')?.hasError('required')">State is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Zip Code</mat-label>
        <input matInput formControlName="zipcode">
        <mat-error *ngIf="address.get('zipcode')?.hasError('required')">Zip Code is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Country</mat-label>
        <input matInput formControlName="country">
        <mat-error *ngIf="address.get('country')?.hasError('required')">Country is required</mat-error>
      </mat-form-field>

      <button mat-icon-button color="warn" (click)="removeAddress(i)">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
    <button mat-raised-button color="primary" (click)="addAddress()">Add Address</button>
  </div>

  <button mat-raised-button color="primary" type="submit">Save</button>
</form>
